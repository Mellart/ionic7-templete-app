<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="close()">Отмена</ion-button>
    </ion-buttons>
    <ion-title>Редактировать задачу</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="save()" [disabled]="!canSave()">Сохранить</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- Название задачи -->
  <ion-item [color]="!isTitleValid ? 'danger' : ''">
    <ion-input
      [(ngModel)]="task.title"
      (ionInput)="validateTitle()"
      (ionBlur)="validateTitle()"
      placeholder="Название задачи *"
      required>
    </ion-input>
  </ion-item>
  <!-- Сообщение об ошибке названия -->
  <div *ngIf="!isTitleValid" class="error-message">
    <ion-text color="danger">{{ titleErrorMessage }}</ion-text>
  </div>

  <!-- Приоритет -->
  <ion-item>
    <ion-select [(ngModel)]="task.priority" placeholder="Приоритет">
      <ion-select-option value="low">Низкий</ion-select-option>
      <ion-select-option value="medium">Средний</ion-select-option>
      <ion-select-option value="high">Высокий</ion-select-option>
    </ion-select>
  </ion-item>

  <!-- Статус -->
  <ion-item>
    <ion-select [(ngModel)]="task.status" placeholder="Статус">
      <ion-select-option value="todo">To Do</ion-select-option>
      <ion-select-option value="inprogress">In Progress</ion-select-option>
      <ion-select-option value="done">Done</ion-select-option>
    </ion-select>
  </ion-item>

  <!-- Описание -->
  <ion-item>
    <ion-textarea
      [(ngModel)]="task.description"
      placeholder="Описание задачи..."
      rows="5">
    </ion-textarea>
  </ion-item>

  <!-- Оценка времени -->
  <ion-item>
    <ion-input
      [(ngModel)]="task.timeEstimate"
      type="number"
      placeholder="Оценка времени (часы)">
    </ion-input>
  </ion-item>

  <!-- Ссылка -->
  <ion-item [color]="!isLinkValid ? 'danger' : ''">
    <ion-input
      [(ngModel)]="task.link"
      (ionInput)="validateLink()"
      (ionBlur)="validateLink()"
      placeholder="Ссылка (http://example.com или example.com)">
    </ion-input>
  </ion-item>
  <!-- Сообщение об ошибке ссылки -->
  <div *ngIf="!isLinkValid" class="error-message">
    <ion-text color="danger">{{ linkErrorMessage }}</ion-text>
  </div>

  <!-- Подсказка по валидации -->
  <ion-card class="hint-card">
    <ion-card-content>
      <ion-text color="medium">
        <strong>Подсказка:</strong> Ссылка должна быть в формате https://example.com или example.com
      </ion-text>
    </ion-card-content>
  </ion-card>
</ion-content>